import streamlit as st
import time

# ุฅุนุฏุงุฏุงุช ุงูุตูุญุฉ
st.set_page_config(page_title="ููุฏ-ูุงุชุดุฑ: ุงููุถุงุก ุงูููุงุฆู", page_icon="โ๏ธ", layout="centered")

# ุงูุชูุณูู ุงูุจุตุฑู (ุดุงุดุฉ ุงุฎุชุฑุงู ุณูููุงุฆูุฉ)
st.markdown("""
    <style>
    .stApp { background-color: #050505; }
    h1, h2, h3, p, label { color: #00FF41 !important; font-family: 'Courier New', Courier, monospace; }
    .stButton > button { width: 100%; border-radius: 0px; background-color: transparent; color: #00FF41; border: 1px solid #00FF41; box-shadow: 0 0 10px #00FF41; }
    .stButton > button:hover { background-color: #00FF41; color: black; }
    .story-box { padding: 30px; border: 1px solid #00FF41; background-color: #0a0a0a; border-radius: 10px; line-height: 2; font-size: 18px; text-align: right; direction: rtl; }
    .decrypting { color: #00FF41; font-weight: bold; animation: scan 2s infinite; }
    @keyframes scan { 0% { opacity: 0.2; } 50% { opacity: 1; } 100% { opacity: 0.2; } }
    </style>
    """, unsafe_allow_html=True)

# ุฅุฏุงุฑุฉ ุงูุญุงูุฉ
if 'scene' not in st.session_state: st.session_state.scene = "intro"

# --- 1. ุงูุจุฏุงูุฉ ูุชูุนูู ุงูุตูุช ---
if st.session_state.scene == "intro":
    st.markdown("<h1>โ๏ธ ููุฏ-ูุงุชุดุฑ: ููุญูุฉ ุงููุถุงุก ุงูุฑููู</h1>", unsafe_allow_html=True)
    st.image("https://r2.erweima.ai/i/6DAnC4M_S2m4_wS_Y1A5pA.png", width=400)
    
    st.warning("โ๏ธ ุชูุจูู ุฃููู: ูุฑุฌู ุชุดุบูู ููุทุน ุงูุตูุช ุฃุฏูุงู ุฃููุงู ูุชูุนูู ุฃุฌูุงุก ุงูุชุญููู")
    # ุฑุงุจุท ุตูุชู ูุจุงุดุฑ ูููุณููู ูุณูุณู ุงููุถุงุก
    st.audio("https://www.soundboard.com/handler/DownLoadTrack.ashx?cliptitle=Yargi+Main+Theme&filename=mt/mtyzodm3nzm2mtyzody5_vj_2bl_2bjv_2bq2u.mp3")
    
    name = st.text_input("ุงููุญูู ุงููุณุคูู ุนู ุงููุถูุฉ (ุฃุฏุฎู ุงุณูู):")
    if st.button("ุชูุนูู ุจุฑูุชูููู ุงูุชุญููู ๐ต๏ธโโ๏ธ"):
        if name:
            st.session_state.name = name
            st.session_state.scene = "long_story"
            st.rerun()

# --- 2. ุงููุตุฉ ุงูุทูููุฉ (ุงููุตู ุงูุฃูู) ---
elif st.session_state.scene == "long_story":
    st.markdown(f"<h2>๐ ููู ุงููุถูุฉ: ุณููุท ุงูุณูุฑูุฑ ุงูุณุญุงุจู</h2>", unsafe_allow_html=True)
    st.markdown(f"""
    <div class="story-box">
    ูููุฉ ุงูุฎููุณุ ุงูุณุงุนุฉ 3:12 ูุฌุฑุงู.. ุจูููุง ูุงู ุงูุฌููุน ูุงุฆูุงูุ ุจุฏุฃุช ุดุงุดุงุช ูุฑูุฒ ุงูุจูุงูุงุช ูู ุงููุฏุฑุณุฉ ุชููุถ ุจุงูููู ุงูุฃุญูุฑ. 
    <b>ุงููุญูู {st.session_state.name}</b>ุ ูุญู ุฃูุงู ุฃุถุฎู ุนูููุฉ ุงุฎุชุฑุงู ูู ุชุงุฑูุฎ ุงูุชุนููู! <br><br>
    ููุฏ ุชุณูู ุงููุฎุชุฑู ุนุจุฑ "ุซุบุฑุฉ ููู ุงูุตูุฑ" (Zero-Day)ุ ูุจุฏุฃ ุจุณุญุจ ูููุงุช ุงูุงุฎุชุจุงุฑุงุช ุงูููุงุฆูุฉ. 
    ููู ุงูุฃูุฑ ูู ูุชููู ููุงุ ููุฏ ูุงู ุงููุงูุฑ ุจุฒุฑุน "ููุจูุฉ ููุทููุฉ" ุณุชุฏูุฑ ูู ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ุฅุฐุง ุญุงูู ุฃู ุดุฎุต ุงุณุชุนุงุฏุฉ ุงููุธุงู ุจุดูู ุฎุงุทุฆ. <br><br>
    <b>ุงูุฃุฏูุฉ ุงููุณุฌูุฉ:</b> <br>
    - ุฑุณุงูุฉ ูุดูุฑุฉ ูุตูุช ูุจุฑูุฏ ุงููููู ุชุญุชูู ุนูู ุชูุงุตูู ุดุฎุตูุฉ ุฌุฏุงู (ููุฏุณุฉ ุงุฌุชูุงุนูุฉ). <br>
    - ูุญุงููุงุช ุฏุฎูู ูุงุดูุฉ ูู 4 ุฏูู ูุฎุชููุฉ ูู ููุณ ุงูููุช ูุชุดุชูุช ุงูุงูุชุจุงู. <br>
    - ุงููุงูุฑ ูุทุงูุจ ุจุญุฐู ุฏุฑุฌุงุช "ุงูุทูุงุจ ุงูุฑุงุณุจูู" ููุงุจู ุฅุนุงุฏุฉ ุงูุณูุฑูุฑ. <br><br>
    ุงูููุช ูุฏุงูููุง.. ุงูุณูุฑูุฑ ุงูุขู ูู ุญุงูุฉ "ููู ุชุงู" ูุงูููุงุชูุญ ุถุงุฆุนุฉ ูู ุฃููุงุฏ ุงููุงูุฑ. 
    ูู ุฃูุช ูุณุชุนุฏุฉ ูููุงุฌูุฉ <b>(ุงูุธู ุงูุฃุณูุฏ)</b> ูู ูุงุนุฉ ุงููุถุงุก ุงูุฑูููุ
    </div>
    """, unsafe_allow_html=True)
    
    if st.button("โ๏ธ ุงูุฏุฎูู ููุงุนุฉ ุงููุถุงุก ูุงูุฅุตูุงุญ"):
        st.session_state.scene = "challenge"
        st.rerun()

# --- 3. ุงูุชุญุฏูุงุช ุงูููุณุนุฉ ---
elif st.session_state.scene == "challenge":
    st.markdown("<h3>๐ก๏ธ ูุญุงูุงุฉ ุงููุฌูู: ุฌุฏุงุฑ ุงูุญูุงูุฉ ุชุญุช ุงูุญุตุงุฑ</h3>", unsafe_allow_html=True)
    st.progress(40) # ุดุฑูุท ุชูุฏู ููุญู ุจุงูุฎุทุฑ
    
    with st.container():
        st.write("๐ **ุงููุบุฒ ุงูุฃูู: ุชุญููู ุงูุฃุซุฑ ุงูุฑููู**")
        st.write("ุงูุชุดูุชู ุฃู ุงููุงูุฑ ุฏุฎู ุนู ุทุฑูู 'ุฑุงุจุท' ูู ุฑุณุงูุฉ ูุตูุฉ. ุฃู ูู ูุฐู ุงูุฑูุงุจุท ูู ุงููุงุชูุ")
        ans1 = st.radio("ุงูุฑุงุจุท ุงูููุชุดู:", ["https://edu-gate-sa.com", "https://moe-gov-sa.login-secure.net", "http://bit.ly/34xZyR"], key="a1")

        st.write("---")
        st.write("๐ **ุงููุบุฒ ุงูุซุงูู: ูู ุชุดููุฑ ูููุฉ ุงููุฑูุฑ**")
        st.write("ุงููุงูุฑ ุชุฑู ุชูููุญุงู: 'ูููุฉ ูุฑูุฑู ุชุญุชูู ุนูู ุงุณู ูุฏุฑุณุชูุ ุฑูุฒ ุฎุงุตุ ูุฑูู ุงูุณูุฉ'. ุฃู ูููุง ุชุชููุนููุ")
        ans2 = st.radio("ุชุฎููู ูููุฉ ุงููุฑูุฑ:", ["School2025", "School@2025", "12345678"], key="a2")

        st.write("---")
        st.write("๐ฆ **ุงููุบุฒ ุงูุซุงูุซ: ุนุฒู ุงูููุฑูุณ**")
        st.write("ุจุฏุฃ ุงูููุฑูุณ ุจูุณุญ ูููุงุช (Excel) ุงูุฎุงุตุฉ ุจุงูุฏุฑุฌุงุช. ููู ุชููููู ุงููุฒูู ููุฑุงูุ")
        ans3 = st.radio("ุงูุฅุฌุฑุงุก ุงูุทุงุฑุฆ:", ["ุฅุบูุงู ุงููุชุตูุญ", "ุนุฒู ุงูุฌูุงุฒ ุนู ุงูุดุจูุฉ (Air-Gapping)", "ุชุบููุฑ ุฎูููุฉ ุงูุดุงุดุฉ"], key="a3")

        st.write("---")
        st.write("๐ค **ุงููุบุฒ ุงูุฑุงุจุน: ุงูููุฏุณุฉ ุงูุงุฌุชูุงุนูุฉ**")
        st.write("ุดุฎุต ุงุชุตู ุจูู ูุฏุนู ุฃูู 'ุฏุนู ููู ูู ูุงููุฑูุณููุช' ููุทูุจ ุงูุชุญูู ุจุฌูุงุฒู ูุฅุตูุงุญู. ูุงุฐุง ุชูุนูููุ")
        ans4 = st.radio("ูุฑุงุฑู:", ["ุฃุนุทูู ุงููุตูู ููุณุงุนุฏูู", "ุฃุบูู ุงูุฎุท ูุฃุจูุบ ุงูุณูุทุงุช", "ุฃุณุฃูู ุนู ุงุณูู ุฃููุงู"], key="a4")

    if st.button("โ๏ธ ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูุฅุตุฏุงุฑ ุงูุญูู"):
        if ans1 == "https://moe-gov-sa.login-secure.net" and ans2 == "School@2025" and ans3 == "ุนุฒู ุงูุฌูุงุฒ ุนู ุงูุดุจูุฉ (Air-Gapping)" and ans4 == "ุฃุบูู ุงูุฎุท ูุฃุจูุบ ุงูุณูุทุงุช":
            st.session_state.scene = "victory"
        else:
            st.error("โ ุชุญุฐูุฑ: ุฅุฌุงุจุงุช ุฎุงุทุฆุฉ ุฃุฏุช ูุฒูุงุฏุฉ ููุฉ ุงูุชุดููุฑ! ุญุงูู ูุฑุฉ ุฃุฎุฑู ูุจู ุงููุฌุงุฑ ุงูุณูุฑูุฑ.")
        st.rerun()

# --- 4. ุงูููุงูุฉ ูุงูุชูููู ---
elif st.session_state.scene == "victory":
    st.balloons()
    st.markdown("<h1>๐ ุงูุชุตุงุฑ ุงูุนุฏุงูุฉ ุงูุฑูููุฉ</h1>", unsafe_allow_html=True)
    st.markdown(f"<div class='story-box'>ููุฏ ูุฌุญุชู ูุง {st.session_state.name}! ุชู ูู ุงูุชุดููุฑุ ูุงููุจุถ ุนูู (ุงูุธู ุงูุฃุณูุฏ). ุงููุฏุฑุณุฉ ุงูุขู ูู ุฃูุงู ุจูุถู ุฐูุงุฆู ูุณุฑุนุฉ ุจุฏููุชู ูู ุงููุถุงุก.</div>", unsafe_allow_html=True)
    
    st.write("---")
    st.subheader("๐ ุชูุฑูุฑ ุงููุญูู ุงูููุงุฆู:")
    final_advice = st.text_area("ุงูุชุจู ูุตุงุฆุญูู ููุฃุฌูุงู ุงููุงุฏูุฉ ูุชุฌูุจ ูุฐุง ุงูุงุฎุชุฑุงู:")
    
    if st.button("ุฎุชู ุงููุถูุฉ ุจุงูุฃุฑุดูู ๐๏ธ"):
        st.markdown("<p class='decrypting'>ุฌุงุฑู ุชุญููู ุงููุตูุญุฉ ุจุงุณุชุฎุฏุงู LAI...</p>", unsafe_allow_html=True)
        time.sleep(2)
        st.success("โ ุชู ุชูููู ูุตูุญุชู ุจู (ููุชุงุฒ). ููุฏ ุฃุตุจุญุชู ุงูุขู ูุฑุฌุนุงู ูู ุงูุฃูู ุงูุณูุจุฑุงูู!")
        st.markdown(f"<h4>ุชุทููุฑ ูุฅุนุฏุงุฏ ุงููุจุฏุนุฉ: ุงูุฌูุฑู โจ</h4>", unsafe_allow_html=True)
        if st.button("ุฅุนุงุฏุฉ ูุชุญ ูุถูุฉ ุฌุฏูุฏุฉ ๐"):
            st.session_state.clear()
            st.rerun()
